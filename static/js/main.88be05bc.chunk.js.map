{"version":3,"sources":["Header.js","Footer.js","ImageDegrader.js","EditorSection.js","index.js"],"names":["Header","props","document","title","githubUrl","Footer","href","getImageFromData","data","Promise","resolve","image","Image","onload","src","processFirstPass","quality","width","height","canvas","createElement","ctx","getContext","fillStyle","fillRect","drawImage","toDataURL","processSecondPass","overlayAmount","colorBurnAmount","globalCompositeOperation","globalAlpha","imageData","degrade","a","resultWidth","resultHeight","result","firstPassScale","EditorSection","state","degradedImageData","degradedImageDataCache","loadSampleImage","Map","set","this","setState","showDegradedImage","event","preventDefault","dataTransfer","items","kind","file","getAsFile","loadImage","Number","target","value","cache","get","getDegradedImage","then","sampleImage","handleImageLoad","URL","reader","FileReader","e","readAsDataURL","getElementById","click","className","onDragOver","handleDragOver","onDrop","handleDrop","type","id","accept","onChange","files","onClick","showImageSelector","alt","min","max","step","handleQualityChange","React","Component","App","ReactDOM","render"],"mappings":"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","file":"static/js/main.88be05bc.chunk.js","sourcesContent":["import React from \"react\";\nimport \"./style.css\";\n\nfunction Header(props) {\n  return (\n    <header>\n      <h1>{document.title}</h1>\n      <p>디지털 풍화를 좋아하시는 여러분을 위한 페이지입니다. 저화질의 이미지를 쉽고 빠르게 만들어 보세요!</p>\n    </header>\n  );\n}\n\nexport default Header;\n","import React from \"react\";\nimport \"./style.css\";\n\nconst githubUrl = \"https://github.com/juo6442/weathering-image\";\n\nfunction Footer(props) {\n  return (\n    <footer>\n      <hr />\n      <p>GitHub: <a href={githubUrl}>{githubUrl}</a></p>\n    </footer>\n  );\n}\n\nexport default Footer;\n","function getImageFromData(data) {\n  return new Promise((resolve) => {\n    const image = new Image();\n    image.onload = () => {\n      resolve(image);\n    };\n    image.src = data;\n  });\n}\n\nfunction processFirstPass(image, quality, width, height) {\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = width;\n  canvas.height = height;\n\n  const ctx = canvas.getContext(\"2d\");\n\n  ctx.fillStyle = \"white\";\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.drawImage(image, 0, 0, canvas.width, canvas.height);\n\n  return canvas.toDataURL(\"image/jpeg\", quality);\n}\n\nfunction processSecondPass(image, overlayAmount, colorBurnAmount, quality, width, height) {\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = width;\n  canvas.height = height;\n\n  const ctx = canvas.getContext(\"2d\");\n  ctx.drawImage(image, 0, 0, canvas.width, canvas.height);\n\n  ctx.globalCompositeOperation = \"overlay\";\n  ctx.fillStyle = \"black\";\n  ctx.globalAlpha = overlayAmount;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  ctx.globalCompositeOperation = \"color-burn\";\n  ctx.fillStyle = \"rgb(230, 225, 170)\";\n  ctx.globalAlpha = colorBurnAmount;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  return canvas.toDataURL(\"image/jpeg\", quality);\n}\n\nasync function getDegradedImage(imageData, degrade) {\n  if (!imageData) return \"\";\n\n  const image = await getImageFromData(imageData);\n  const resultWidth = image.width;\n  const resultHeight = image.height;\n\n  const firstPassScale = (1 - degrade / 100) * 0.5 + 0.5;\n  let result = processFirstPass(\n    image,\n    (100 - degrade) / 100,\n    resultWidth * firstPassScale, resultHeight * firstPassScale);\n\n  result = processSecondPass(\n    await getImageFromData(result),\n    degrade / 100 * 0.1,\n    degrade / 100,\n    (100 - degrade) / 100,\n    resultWidth, resultHeight);\n\n  return result;\n}\n\nexport { getDegradedImage };\n","import React from \"react\";\nimport { getDegradedImage } from \"./ImageDegrader\";\nimport \"./style.css\";\n\nclass EditorSection extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      imageData: null,\n      degrade: 0,\n      degradedImageData: null,\n      degradedImageDataCache: null,\n    };\n\n    this.loadSampleImage();\n  }\n\n  handleImageLoad(data) {\n    const degradedImageDataCache = new Map();\n    degradedImageDataCache.set(0, data);\n\n    this.setState({\n      degrade: 0,\n      imageData: data,\n      degradedImageData: data,\n      degradedImageDataCache: degradedImageDataCache,\n    }, () => this.showDegradedImage(this.state.degrade));\n  }\n\n  handleDragOver(event) {\n    event.preventDefault();\n  }\n\n  handleDrop(event) {\n    event.preventDefault();\n\n    if (event.dataTransfer.items[0].kind === \"file\") {\n      const file = event.dataTransfer.items[0].getAsFile();\n      this.loadImage(file);\n    }\n  }\n\n  handleQualityChange(event) {\n    this.setState({\n      degrade: Number(event.target.value),\n    }, () => this.showDegradedImage(this.state.degrade));\n  }\n\n  showDegradedImage(degrade) {\n    const cache = this.state.degradedImageDataCache.get(degrade);\n    if (cache) {\n      this.setState({\n        degradedImageData: cache,\n      });\n      return;\n    }\n\n    getDegradedImage(this.state.imageData, degrade)\n      .then((result) => {\n        const degradedImageDataCache = new Map(this.state.degradedImageDataCache);\n        degradedImageDataCache.set(degrade, result);\n\n        this.setState({\n          degradedImageData: result,\n          degradedImageDataCache: degradedImageDataCache,\n        });\n      });\n  }\n\n  loadSampleImage() {\n    const sampleImage = new Image();\n    sampleImage.onload = () => {\n      const canvas = document.createElement(\"canvas\");\n      canvas.width = 400;\n      canvas.height = 400;\n      const ctx = canvas.getContext(\"2d\");\n      ctx.drawImage(sampleImage, 0, 0, canvas.width, canvas.height);\n\n      this.handleImageLoad(canvas.toDataURL(\"Image/jpeg\"));\n    }\n    sampleImage.src = document.URL + \"/sample.png\";\n  }\n\n  loadImage(file) {\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = (e) => this.handleImageLoad(e.target.result);\n    reader.readAsDataURL(file);\n  }\n\n  showImageSelector() {\n    const selector = document.getElementById(\"imageSelector\");\n    selector.click();\n  }\n\n  render() {\n    return (\n      <section className=\"imageEditor\"\n        onDragOver={(event) => this.handleDragOver(event)}\n        onDrop={(event) => this.handleDrop(event)}\n      >\n        <div className=\"buttonContainer\">\n          <input type=\"file\" id=\"imageSelector\" accept=\"image/*\"\n            onChange={(event) => this.loadImage(event.target.files[0])}\n          />\n          <input type=\"button\" value=\"이미지 불러오기\"\n            onClick={() => this.showImageSelector()}\n          />\n        </div>\n\n        <img className=\"image\" alt=\"불러온 이미지\"\n          src={this.state.degradedImageData}\n        />\n\n        <input type=\"range\"\n          min=\"0\" max=\"100\" step=\"5\"\n          value={this.state.degrade}\n          onChange={(event) => this.handleQualityChange(event)}\n        />\n      </section>\n    );\n  }\n}\n\nexport default EditorSection;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport EditorSection from \"./EditorSection\";\nimport \"./style.css\";\n\nfunction App(props) {\n  return (\n    <>\n      <Header />\n      <EditorSection />\n      <Footer />\n    </>\n  );\n}\n\nReactDOM.render(\n  <App />,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}